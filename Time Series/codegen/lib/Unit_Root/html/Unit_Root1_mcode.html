<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">Output</span> = Unit_Root(<span class="var type1" id="S3T2U6">Data</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line">coder.extrinsic(<span class="string">'format'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line">coder.extrinsic(<span class="string">'clc'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="mxinfo " id="T2:U3"><span class="var type1" id="S3T2U21">Data</span> = <span class="mxinfo " id="T2:U5"><span class="fcn" id="F2N11:B23">demeanc</span>(<span class="var type1" id="S3T2U24">Data</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="mxinfo " id="T4:U7"><span class="var type1" id="S6T4U27">T</span> = <span class="mxinfo " id="T4:U9"><span class="fcn" id="F3N24:B29">rows</span>(<span class="var type1" id="S3T2U30">Data</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%% Estimating y(t) = phi*y(t-1) + error</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="mxinfo " id="T3:U11"><span class="var type1" id="S8T3U33">phim</span> = <span class="mxinfo " id="T3:U13">zeros(<span class="mxinfo " id="T4:U14">10000</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="mxinfo " id="T3:U15"><span class="var type1" id="S10T3U40">sig2m</span> = <span class="mxinfo " id="T3:U17">zeros(<span class="mxinfo " id="T4:U18">10000</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo " id="T2:U19"><span class="var type1" id="S11T2U47">Y</span> = <span class="mxinfo " id="T2:U21"><span class="fcn" id="F41N2:B49">AR</span>(<span class="var type1" id="S3T2U50">Data</span>,0,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="mxinfo " id="T2:U23"><span class="var type1" id="S13T2U55">X</span> = <span class="mxinfo " id="T2:U25"><span class="fcn" id="F42N2:B57">AR</span>(<span class="var type1" id="S3T2U58">Data</span>,1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo " id="T4:U27"><span class="var type1" id="S14T4U63">a_0</span> = <span class="mxinfo " id="T4:U29">4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo " id="T4:U30"><span class="var type1" id="S15T4U67">d_0</span> = <span class="mxinfo " id="T4:U32"><span class="mxinfo " id="T4:U33">var(<span class="mxinfo " id="T2:U34">diff(<span class="var type1" id="S3T2U73">Data</span>)</span>)</span>*<span class="var type1" id="S14T4U74">a_0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T4:U37"><span class="var type1" id="S18T4U77">sig2</span> = <span class="mxinfo " id="T4:U39">var(<span class="mxinfo " id="T2:U40">diff(<span class="var type1" id="S3T2U82">Data</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo " id="T5:U42"><span class="var type1" id="S19T5U85">b_hat</span> = <span class="mxinfo " id="T4:U44">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T4:U45"><span class="var type1" id="S20T4U89">sig2_hat</span> = <span class="var type1" id="S18T4U90">sig2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo " id="T4:U48"><span class="var type1" id="S21T4U93">lnpost_hat</span> = <span class="mxinfo " id="T4:U50">-<span class="mxinfo " id="T4:U51">exp(<span class="mxinfo " id="T4:U52">20</span>)</span></span></span>;<span class="comment">% 임의로 값을 주고 시작함</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S23T4U100">iter</span> = <span class="mxinfo " id="T3:U54"><span class="mxinfo " id="T4:U55">1</span>:10000</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">    [<span class="mxinfo " id="T4:U56">~</span>, <span class="var type1" id="S24T4U108">resid</span>] = <span class="fcn" id="F83N21:B110">minresid</span>(<span class="var type1" id="S23T4U111">iter</span>,<span class="mxinfo " id="T4:U59">1000</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T6:U60"><span class="var type1" id="S24T4U116">resid</span> == <span class="mxinfo " id="T4:U62">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">        <span class="mxinfo " id="T7:U63"><span class="extrinsicFcn" id="F85N7:B120">clc</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">        <span class="mxinfo " id="T7:U64"><span class="autoExtrinsicFcn" id="F86N12:B123">disp</span>(<span class="mxinfo " id="T8:U65"><span class="string">'Estimating Unresticted Regression'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">        <span class="mxinfo " id="T7:U66"><span class="autoExtrinsicFcn" id="F87N12:B127">disp</span>(<span class="mxinfo " id="T9:U67"><span class="string">'====================================='</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">        fprintf(<span class="string">'Current iteration: %G percent \n'</span>,<span class="mxinfo " id="T4:U68"><span class="var type1" id="S23T4U134">iter</span>/<span class="mxinfo " id="T4:U70">10000</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">        <span class="mxinfo " id="T7:U71"><span class="autoExtrinsicFcn" id="F118N12:B138">disp</span>(<span class="mxinfo " id="T9:U72"><span class="string">'====================================='</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">        <span class="mxinfo " id="T7:U73"><span class="autoExtrinsicFcn" id="F119N12:B142">disp</span>(<span class="mxinfo " id="T10:U74"><span class="string">' '</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">        <span class="mxinfo " id="T7:U75"><span class="autoExtrinsicFcn" id="F120N12:B146">disp</span>(<span class="mxinfo " id="T11:U76"><span class="string">'[phi: ]'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">        disp(<span class="var type0" id="S29T0U152"><span class="message error" id="M1F1C">b_1</span></span>')</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">        <span class="mxinfo " id="T7:U77"><span class="autoExtrinsicFcn" id="F121N12:B155">disp</span>(<span class="mxinfo " id="T12:U78"><span class="string">'[sig2: ]'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">        <span class="mxinfo " id="T7:U79"><span class="autoExtrinsicFcn" id="F122N12:B159">disp</span>(<span class="var type1" id="S18T4U160">sig2</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    <span class="mxinfo " id="T5:U81"><span class="var type1" id="S29T5U163">b_1</span> = <span class="mxinfo " id="T5:U83"><span class="fcn" id="F123N4:B165">Gen_beta</span>(<span class="var type1" id="S11T2U166">Y</span>,<span class="var type1" id="S13T2U167">X</span>,<span class="mxinfo " id="T4:U86">0</span>,<span class="mxinfo " id="T4:U87">0.25</span>,<span class="var type1" id="S18T4U170">sig2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">    <span class="message error" id="M4F1C"><span class="mxinfo " id="T4:U89"><span class="var type1" id="S8T3U174">phim</span>(<span class="var type1" id="S23T4U175">iter</span>,<span class="mxinfo " id="T13:U92">:</span>)</span> = <span class="var type1" id="S29T5U177">b_1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="mxinfo " id="T4:U94"><span class="var type1" id="S18T4U180">sig2</span> = <span class="mxinfo " id="T4:U96"><span class="fcn" id="F338N5:B182">Gen_sig2</span>(<span class="var type1" id="S11T2U183">Y</span>,<span class="var type1" id="S13T2U184">X</span>,<span class="var type1" id="S29T5U185">b_1</span>,<span class="var type1" id="S14T4U186">a_0</span>,<span class="var type1" id="S15T4U187">d_0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="mxinfo " id="T4:U102"><span class="mxinfo " id="T4:U103"><span class="var type1" id="S10T3U191">sig2m</span>(<span class="var type1" id="S23T4U192">iter</span>,<span class="mxinfo " id="T13:U106">:</span>)</span> = <span class="var type1" id="S18T4U194">sig2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T4:U108"><span class="var type1" id="S32T4U197">lnlik1</span> = <span class="mxinfo " id="T4:U110">sum(<span class="mxinfo " id="T2:U111"><span class="fcn" id="F419N18:B201">lnpdfn</span>(<span class="var type1" id="S11T2U202">Y</span>, <span class="mxinfo " id="T5:U113"><span class="var type1" id="S13T2U204">X</span>*<span class="var type1" id="S29T5U205">b_1</span></span>, <span class="var type1" id="S18T4U206">sig2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T2:U117"><span class="var type1" id="S35T2U209">b_prior</span> = <span class="mxinfo " id="T2:U119"><span class="fcn" id="F434N17:B211">lnpdfmvn</span>(<span class="var type1" id="S29T5U212">b_1</span>,<span class="mxinfo " id="T4:U121">0</span>,0.25)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo " id="T4:U122"><span class="var type1" id="S37T4U217">sig2_prior</span> = <span class="mxinfo " id="T4:U124"><span class="fcn" id="F466N16:B219">lnpdfig</span>(<span class="var type1" id="S18T4U220">sig2</span>,<span class="mxinfo " id="T4:U126"><span class="var type1" id="S14T4U222">a_0</span>/2</span>,<span class="mxinfo " id="T4:U128"><span class="var type1" id="S15T4U225">d_0</span>/<span class="mxinfo " id="T4:U130">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T2:U131"><span class="var type1" id="S39T2U229">lnprior1</span> = <span class="mxinfo " id="T2:U133"><span class="var type1" id="S35T2U231">b_prior</span>+<span class="var type1" id="S37T4U232">sig2_prior</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo " id="T2:U136"><span class="var type1" id="S40T2U235">lnpost1</span> = <span class="mxinfo " id="T2:U138"><span class="var type1" id="S32T4U237">lnlik1</span> + <span class="var type1" id="S39T2U238">lnprior1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T14:U141"><span class="message error" id="M2F1C"><span class="var type1" id="S40T2U242">lnpost1</span> &gt; <span class="var type1" id="S21T4U243">lnpost_hat</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">        <span class="mxinfo " id="T5:U144"><span class="var type1" id="S19T5U246">b_hat</span> = <span class="var type1" id="S29T5U247">b_1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">        <span class="mxinfo " id="T4:U147"><span class="var type1" id="S20T4U250">sig2_hat</span> = <span class="var type1" id="S18T4U251">sig2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">        <span class="mxinfo " id="T4:U150"><span class="var type1" id="S21T4U254"><span class="message error" id="M3F1C">lnpost_hat</span></span></span> = <span class="var type1" id="S40T2U255">lnpost1</span>; <span class="comment">% 최빈값 후보의 사후 커널값</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo " id="T4:U152"><span class="var type1" id="S41T4U258">XX</span> = <span class="mxinfo " id="T4:U154"><span class="mxinfo " id="T15:U155"><span class="var type1" id="S13T2U261">X</span>'</span>*<span class="var type1" id="S13T2U262">X</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="mxinfo " id="T4:U158"><span class="var type1" id="S42T4U265">XY</span> = <span class="mxinfo " id="T4:U160"><span class="mxinfo " id="T15:U161"><span class="var type1" id="S13T2U268">X</span>'</span>*<span class="var type1" id="S11T2U269">Y</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="mxinfo " id="T4:U164"><span class="var type1" id="S43T4U272">sig2_inv</span> = <span class="mxinfo " id="T4:U166"><span class="mxinfo " id="T4:U167">1</span>/<span class="var type1" id="S20T4U275">sig2_hat</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo " id="T4:U169"><span class="var type1" id="S44T4U278">B_1</span> = <span class="mxinfo " id="T4:U171"><span class="mxinfo " id="T4:U172">1</span>/(<span class="mxinfo " id="T4:U173"><span class="mxinfo " id="T4:U174"><span class="var type1" id="S43T4U284">sig2_inv</span>*<span class="var type1" id="S41T4U285">XX</span></span> + <span class="mxinfo " id="T4:U177">4</span></span>)</span></span>; <span class="comment">% full conditional variance B_1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo " id="T4:U178"><span class="var type1" id="S45T4U289">A</span> = <span class="mxinfo " id="T4:U180"><span class="var type1" id="S43T4U291">sig2_inv</span>*<span class="var type1" id="S42T4U292">XY</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo " id="T4:U183"><span class="var type1" id="S46T4U295">M</span> = <span class="mxinfo " id="T4:U185"><span class="var type1" id="S44T4U297">B_1</span>*<span class="var type1" id="S45T4U298">A</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="mxinfo " id="T2:U188"><span class="var type1" id="S47T2U301">lnfcb</span> = <span class="mxinfo " id="T2:U190"><span class="fcn" id="F472N17:B303">lnpdfmvn</span>(<span class="var type1" id="S19T5U304">b_hat</span>,<span class="var type1" id="S46T4U305">M</span>,<span class="var type1" id="S44T4U306">B_1</span>)</span></span>; <span class="comment">% log full conditional distribution density value for beta</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo " id="T3:U194"><span class="var type1" id="S48T3U309">igpdfm</span> = <span class="mxinfo " id="T3:U196">zeros(<span class="mxinfo " id="T4:U197">10000</span>,1)</span></span>; <span class="comment">%Saving room for full conditional value for sig2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo " id="T4:U198"><span class="var type1" id="S49T4U316">a_1</span> = <span class="mxinfo " id="T4:U200">(<span class="mxinfo " id="T4:U201"><span class="var type1" id="S6T4U320">T</span>-<span class="mxinfo " id="T4:U203">1</span></span>) + <span class="var type1" id="S14T4U322">a_0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S23T4U325">iter</span> = <span class="mxinfo " id="T3:U206"><span class="mxinfo " id="T4:U207">1</span>:10000</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">    [<span class="mxinfo " id="T4:U208">~</span>, <span class="var type1" id="S24T4U333">resid</span>] = <span class="fcn" id="F83N21:B335">minresid</span>(<span class="var type1" id="S23T4U336">iter</span>,<span class="mxinfo " id="T4:U211">1000</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T6:U212"><span class="var type1" id="S24T4U341">resid</span> == <span class="mxinfo " id="T4:U214">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">        <span class="mxinfo " id="T7:U215"><span class="extrinsicFcn" id="F480N7:B345">clc</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">        <span class="mxinfo " id="T7:U216"><span class="autoExtrinsicFcn" id="F481N12:B348">disp</span>(<span class="mxinfo " id="T16:U217"><span class="string">'Calculating Marginal Likelihood(Chib Method)'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">        <span class="mxinfo " id="T7:U218"><span class="autoExtrinsicFcn" id="F482N12:B352">disp</span>(<span class="mxinfo " id="T9:U219"><span class="string">'====================================='</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">        fprintf(<span class="string">'Current iteration: %G percent \n'</span>,<span class="mxinfo " id="T4:U220"><span class="var type1" id="S23T4U359">iter</span>/<span class="mxinfo " id="T4:U222">10000</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">        <span class="mxinfo " id="T7:U223"><span class="autoExtrinsicFcn" id="F483N12:B363">disp</span>(<span class="mxinfo " id="T9:U224"><span class="string">'====================================='</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">        <span class="mxinfo " id="T7:U225"><span class="autoExtrinsicFcn" id="F484N12:B367">disp</span>(<span class="mxinfo " id="T10:U226"><span class="string">' '</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">        <span class="mxinfo " id="T7:U227"><span class="autoExtrinsicFcn" id="F485N12:B371">disp</span>(<span class="mxinfo " id="T12:U228"><span class="string">'[sig2: ]'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">        <span class="mxinfo " id="T7:U229"><span class="autoExtrinsicFcn" id="F486N12:B375">disp</span>(<span class="var type1" id="S18T4U376">sig2</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="mxinfo " id="T4:U231"><span class="var type1" id="S50T4U379">b</span> = <span class="mxinfo " id="T4:U233"><span class="var type1" id="S8T3U381">phim</span>(<span class="var type1" id="S23T4U382">iter</span>,<span class="mxinfo " id="T13:U236">:</span>)</span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="mxinfo " id="T2:U237"><span class="var type1" id="S51T2U386">e</span> = <span class="mxinfo " id="T2:U239"><span class="var type1" id="S11T2U388">Y</span> - <span class="mxinfo " id="T2:U241"><span class="var type1" id="S13T2U390">X</span>*<span class="var type1" id="S50T4U391">b</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo " id="T4:U244"><span class="var type1" id="S52T4U394">d_1</span> = <span class="mxinfo " id="T4:U246"><span class="var type1" id="S15T4U396">d_0</span> + <span class="mxinfo " id="T4:U248"><span class="mxinfo " id="T15:U249"><span class="var type1" id="S51T2U399">e</span>'</span>*<span class="var type1" id="S51T2U400">e</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="mxinfo " id="T4:U252"><span class="mxinfo " id="T4:U253"><span class="var type1" id="S48T3U404">igpdfm</span>(<span class="var type1" id="S23T4U405">iter</span>)</span> = <span class="mxinfo " id="T4:U256">exp(<span class="mxinfo " id="T4:U257"><span class="fcn" id="F466N16:B409">lnpdfig</span>(<span class="var type1" id="S20T4U410">sig2_hat</span>,<span class="mxinfo " id="T4:U259"><span class="var type1" id="S49T4U412">a_1</span>/<span class="mxinfo " id="T4:U261">2</span></span>,<span class="mxinfo " id="T4:U262"><span class="var type1" id="S52T4U415">d_1</span>/<span class="mxinfo " id="T4:U264">2</span></span>)</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">% iter 번째 simulation된 beta값 하에서 sig2 최빈값의 완전조건부 밀도함수값</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="mxinfo " id="T4:U265"><span class="var type1" id="S53T4U419">igpdf</span> = <span class="mxinfo " id="T4:U267"><span class="fcn" id="F487N19:B421">meanc</span>(<span class="var type1" id="S48T3U422">igpdfm</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="mxinfo " id="T4:U269"><span class="var type1" id="S55T4U425">lnig</span> = <span class="mxinfo " id="T4:U271">log(<span class="var type1" id="S53T4U428">igpdf</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo " id="T2:U273"><span class="var type1" id="S57T2U431">ln_joint_post</span> = <span class="mxinfo " id="T2:U275"><span class="var type1" id="S47T2U433">lnfcb</span> + <span class="var type1" id="S55T4U434">lnig</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo " id="T2:U278"><span class="var type1" id="S58T2U437">lnML_Un</span> = <span class="mxinfo " id="T2:U280"><span class="var type1" id="S21T4U439">lnpost_hat</span> - <span class="var type1" id="S57T2U440">ln_joint_post</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="comment">%% Estimating y(t)-y(t-1) = error</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo " id="T2:U283"><span class="var type1" id="S3T2U443">Data</span> = <span class="mxinfo " id="T2:U285">diff(<span class="var type1" id="S3T2U446">Data</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="mxinfo " id="T3:U287"><span class="var type1" id="S10T3U449">sig2m</span> = <span class="mxinfo " id="T3:U289">zeros(<span class="mxinfo " id="T4:U290">10000</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo " id="T4:U291"><span class="var type1" id="S14T4U456">a_0</span> = <span class="mxinfo " id="T4:U293">4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="mxinfo " id="T4:U294"><span class="var type1" id="S15T4U460">d_0</span> = <span class="mxinfo " id="T4:U296"><span class="mxinfo " id="T4:U297">var(<span class="var type1" id="S3T2U464">Data</span>)</span>*<span class="var type1" id="S14T4U465">a_0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo " id="T4:U300"><span class="var type1" id="S18T4U468">sig2</span> = <span class="mxinfo " id="T4:U302">var(<span class="var type1" id="S3T2U471">Data</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo " id="T4:U304"><span class="var type1" id="S20T4U474">sig2_hat</span> = <span class="var type1" id="S18T4U475">sig2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo " id="T4:U307"><span class="var type1" id="S21T4U478">lnpost_hat</span> = <span class="mxinfo " id="T4:U309">-<span class="mxinfo " id="T4:U310">exp(<span class="mxinfo " id="T4:U311">20</span>)</span></span></span>;<span class="comment">% 임의로 값을 주고 시작함</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S23T4U485">iter</span> = <span class="mxinfo " id="T3:U313"><span class="mxinfo " id="T4:U314">1</span>:10000</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    [<span class="mxinfo " id="T4:U315">~</span>, <span class="var type1" id="S24T4U493">resid</span>] = <span class="fcn" id="F83N21:B495">minresid</span>(<span class="var type1" id="S23T4U496">iter</span>,<span class="mxinfo " id="T4:U318">1000</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T6:U319"><span class="var type1" id="S24T4U501">resid</span> == <span class="mxinfo " id="T4:U321">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">        <span class="mxinfo " id="T7:U322"><span class="extrinsicFcn" id="F507N7:B505">clc</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">        <span class="mxinfo " id="T7:U323"><span class="autoExtrinsicFcn" id="F508N12:B508">disp</span>(<span class="mxinfo " id="T17:U324"><span class="string">'Estimating Resticted Regression'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">        <span class="mxinfo " id="T7:U325"><span class="autoExtrinsicFcn" id="F509N12:B512">disp</span>(<span class="mxinfo " id="T9:U326"><span class="string">'====================================='</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">        fprintf(<span class="string">'Current iteration: %G percent \n'</span>,<span class="mxinfo " id="T4:U327"><span class="var type1" id="S23T4U519">iter</span>/<span class="mxinfo " id="T4:U329">10000</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">        <span class="mxinfo " id="T7:U330"><span class="autoExtrinsicFcn" id="F510N12:B523">disp</span>(<span class="mxinfo " id="T9:U331"><span class="string">'====================================='</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">        <span class="mxinfo " id="T7:U332"><span class="autoExtrinsicFcn" id="F511N12:B527">disp</span>(<span class="mxinfo " id="T10:U333"><span class="string">' '</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">        <span class="mxinfo " id="T7:U334"><span class="autoExtrinsicFcn" id="F512N12:B531">disp</span>(<span class="mxinfo " id="T12:U335"><span class="string">'[sig2: ]'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">        <span class="mxinfo " id="T7:U336"><span class="autoExtrinsicFcn" id="F513N12:B535">disp</span>(<span class="var type1" id="S18T4U536">sig2</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">    <span class="mxinfo " id="T4:U338"><span class="var type1" id="S49T4U539">a_1</span> = <span class="mxinfo " id="T4:U340">(<span class="mxinfo " id="T4:U341"><span class="var type1" id="S6T4U543">T</span>-<span class="mxinfo " id="T4:U343">1</span></span>) + <span class="var type1" id="S14T4U545">a_0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="mxinfo " id="T4:U345"><span class="var type1" id="S52T4U548">d_1</span> = <span class="mxinfo " id="T4:U347"><span class="var type1" id="S15T4U550">d_0</span> + <span class="mxinfo " id="T4:U349"><span class="mxinfo " id="T15:U350"><span class="var type1" id="S3T2U553">Data</span>'</span>*<span class="var type1" id="S3T2U554">Data</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">    <span class="mxinfo " id="T4:U353"><span class="var type1" id="S18T4U557">sig2</span> = <span class="mxinfo " id="T4:U355"><span class="fcn" id="F342N23:B559">randig</span>(<span class="mxinfo " id="T4:U356"><span class="var type1" id="S49T4U561">a_1</span>/<span class="mxinfo " id="T4:U358">2</span></span>,<span class="mxinfo " id="T4:U359"><span class="var type1" id="S52T4U564">d_1</span>/<span class="mxinfo " id="T4:U361">2</span></span>,1,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">    <span class="mxinfo " id="T4:U362"><span class="mxinfo " id="T4:U363"><span class="var type1" id="S10T3U571">sig2m</span>(<span class="var type1" id="S23T4U572">iter</span>,<span class="mxinfo " id="T4:U366">1</span>)</span> = <span class="var type1" id="S18T4U574">sig2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">    <span class="mxinfo " id="T4:U368"><span class="var type1" id="S32T4U577">lnlik1</span> = <span class="mxinfo " id="T4:U370">sum(<span class="mxinfo " id="T2:U371"><span class="fcn" id="F514N18:B581">lnpdfn</span>(<span class="var type1" id="S3T2U582">Data</span>, <span class="mxinfo " id="T4:U373">0</span>, <span class="var type1" id="S18T4U584">sig2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">    <span class="mxinfo " id="T4:U375"><span class="var type1" id="S37T4U587">sig2_prior</span> = <span class="mxinfo " id="T4:U377"><span class="fcn" id="F466N16:B589">lnpdfig</span>(<span class="var type1" id="S18T4U590">sig2</span>,<span class="mxinfo " id="T4:U379"><span class="var type1" id="S14T4U592">a_0</span>/2</span>,<span class="mxinfo " id="T4:U381"><span class="var type1" id="S15T4U595">d_0</span>/<span class="mxinfo " id="T4:U383">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">    <span class="mxinfo " id="T4:U384"><span class="var type1" id="S39T4U599">lnprior1</span> = <span class="var type1" id="S37T4U600">sig2_prior</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">    <span class="mxinfo " id="T4:U387"><span class="var type1" id="S40T4U603">lnpost1</span> = <span class="mxinfo " id="T4:U389"><span class="var type1" id="S32T4U605">lnlik1</span> + <span class="var type1" id="S39T4U606">lnprior1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T6:U392"><span class="var type1" id="S40T4U610">lnpost1</span> &gt; <span class="var type1" id="S21T4U611">lnpost_hat</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">        <span class="mxinfo " id="T4:U395"><span class="var type1" id="S20T4U614">sig2_hat</span> = <span class="var type1" id="S18T4U615">sig2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">        <span class="mxinfo " id="T4:U398"><span class="var type1" id="S21T4U618">lnpost_hat</span> = <span class="var type1" id="S40T4U619">lnpost1</span></span>; <span class="comment">% 최빈값 후보의 사후 커널값</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="mxinfo " id="T4:U401"><span class="var type1" id="S49T4U622">a_1</span> = <span class="mxinfo " id="T4:U403">(<span class="mxinfo " id="T4:U404"><span class="var type1" id="S6T4U626">T</span>-<span class="mxinfo " id="T4:U406">1</span></span>) + <span class="var type1" id="S14T4U628">a_0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="mxinfo " id="T4:U408"><span class="var type1" id="S52T4U631">d_1</span> = <span class="mxinfo " id="T4:U410"><span class="var type1" id="S15T4U633">d_0</span> + <span class="mxinfo " id="T4:U412"><span class="mxinfo " id="T15:U413"><span class="var type1" id="S3T2U636">Data</span>'</span>*<span class="var type1" id="S3T2U637">Data</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"><span class="mxinfo " id="T4:U416"><span class="var type1" id="S57T4U640">ln_joint_post</span> = <span class="mxinfo " id="T4:U418">exp(<span class="mxinfo " id="T4:U419"><span class="fcn" id="F466N16:B644">lnpdfig</span>(<span class="var type1" id="S20T4U645">sig2_hat</span>,<span class="mxinfo " id="T4:U421"><span class="var type1" id="S49T4U647">a_1</span>/<span class="mxinfo " id="T4:U423">2</span></span>,<span class="mxinfo " id="T4:U424"><span class="var type1" id="S52T4U650">d_1</span>/<span class="mxinfo " id="T4:U426">2</span></span>)</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"><span class="mxinfo " id="T4:U427"><span class="var type1" id="S60T4U654">lnML_Re</span> = <span class="mxinfo " id="T4:U429"><span class="var type1" id="S21T4U656">lnpost_hat</span> - <span class="var type1" id="S57T4U657">ln_joint_post</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line"><span class="mxinfo " id="T2:U432"><span class="mxinfo " id="T2:U433"><span class="var type1" id="S2T1U661">Output</span>.lnML_Un</span> = <span class="var type1" id="S58T2U663">lnML_Un</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"><span class="mxinfo " id="T3:U436"><span class="mxinfo " id="T3:U437"><span class="var type1" id="S2T1U667">Output</span>.phim</span> = <span class="var type1" id="S8T3U669">phim</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"><span class="mxinfo " id="T4:U440"><span class="mxinfo " id="T4:U441"><span class="var type1" id="S2T1U673">Output</span>.lnML_Re</span> = <span class="var type1" id="S60T4U675">lnML_Re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"></span></span>
</pre>
