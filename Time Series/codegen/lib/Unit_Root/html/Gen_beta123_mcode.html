<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S62T5U678">beta</span> ] = Gen_beta(<span class="var type1" id="S63T2U681">Y</span>, <span class="var type1" id="S64T2U682">X</span>, <span class="var type1" id="S65T4U683">b_0</span>, <span class="var type1" id="S66T4U684">precB_0</span>, <span class="var type1" id="S67T4U685">sig2</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo " id="T4:U7"><span class="var type1" id="S68T4U688">k</span> = <span class="mxinfo " id="T4:U9"><span class="fcn" id="F4N10:B690">cols</span>(<span class="var type1" id="S64T2U691">X</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo " id="T4:U11"><span class="var type1" id="S70T4U694">XX</span> = <span class="mxinfo " id="T4:U13"><span class="mxinfo " id="T15:U14"><span class="var type1" id="S64T2U697">X</span>'</span>*<span class="var type1" id="S64T2U698">X</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo " id="T4:U17"><span class="var type1" id="S71T4U701">XY</span> = <span class="mxinfo " id="T4:U19"><span class="mxinfo " id="T15:U20"><span class="var type1" id="S64T2U704">X</span>'</span>*<span class="var type1" id="S63T2U705">Y</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo " id="T5:U23"><span class="var type1" id="S72T5U708">B_1</span> = <span class="mxinfo " id="T5:U25"><span class="fcn" id="F136N14:B710">invpd</span>(<span class="mxinfo " id="T4:U26"><span class="mxinfo " id="T4:U27">(<span class="mxinfo " id="T4:U28"><span class="mxinfo " id="T4:U29">1</span>/<span class="var type1" id="S67T4U716">sig2</span></span>)*<span class="var type1" id="S70T4U717">XX</span></span> + <span class="var type1" id="S66T4U718">precB_0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo " id="T4:U33"><span class="var type1" id="S74T4U721">A</span> = <span class="mxinfo " id="T4:U35"><span class="mxinfo " id="T4:U36">(<span class="mxinfo " id="T4:U37"><span class="mxinfo " id="T4:U38">1</span>/<span class="var type1" id="S67T4U727">sig2</span></span>)*<span class="var type1" id="S71T4U728">XY</span></span> + <span class="mxinfo " id="T4:U41"><span class="var type1" id="S66T4U730">precB_0</span>*<span class="var type1" id="S65T4U731">b_0</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo " id="T5:U44"><span class="var type1" id="S75T5U734">M</span> = <span class="mxinfo " id="T5:U46"><span class="var type1" id="S72T5U736">B_1</span>*<span class="var type1" id="S74T4U737">A</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo " id="T5:U49"><span class="var type1" id="S62T5U740">beta</span> = <span class="mxinfo " id="T5:U51"><span class="var type1" id="S75T5U742">M</span> + <span class="mxinfo " id="T5:U53"><span class="mxinfo " id="T5:U54"><span class="mxinfo " id="T5:U55">chol(<span class="var type1" id="S72T5U747">B_1</span>)</span>'</span>*<span class="mxinfo " id="T4:U57">randn(<span class="var type1" id="S68T4U750">k</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"></span></span>
</pre>
