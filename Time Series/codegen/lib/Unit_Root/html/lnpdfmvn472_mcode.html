<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="129,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T2U3">p</span> = lnpdfmvn(<span class="var type1" id="S3T5U6">x</span>, <span class="var type1" id="S4T4U7">m</span>, <span class="var type1" id="S5T4U8">C</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="129,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% GAUSSIAN_PROB Evaluate a multivariate Gaussian density.</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% x =  d by 1 vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T4:U5"><span class="var type1" id="S6T4U11">d</span> = <span class="mxinfo " id="T4:U7">length(<span class="var type1" id="S3T5U14">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T4:U9"><span class="var type1" id="S8T4U17">denom</span> = <span class="mxinfo " id="T4:U11"><span class="mxinfo " id="T4:U12">(<span class="mxinfo " id="T4:U13">2*pi</span>)^(<span class="mxinfo " id="T4:U14"><span class="var type1" id="S6T4U27">d</span>/<span class="mxinfo " id="T4:U16">2</span></span>)</span>*<span class="mxinfo " id="T4:U17">sqrt(<span class="mxinfo " id="T4:U18">abs(<span class="mxinfo " id="T4:U19">det(<span class="var type1" id="S5T4U35">C</span>)</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T2:U21"><span class="var type1" id="S13T2U38">mahal</span> = <span class="mxinfo " id="T2:U23">sum(<span class="mxinfo " id="T5:U24">(<span class="mxinfo " id="T5:U25"><span class="mxinfo " id="T5:U26">(<span class="mxinfo " id="T5:U27"><span class="var type1" id="S3T5U47">x</span>-<span class="var type1" id="S4T4U48">m</span></span>)'</span>*<span class="mxinfo " id="T5:U30"><span class="fcn" id="F136N14:B50">invpd</span>(<span class="var type1" id="S5T4U51">C</span>)</span></span>).*<span class="mxinfo " id="T5:U32">(<span class="mxinfo " id="T5:U33"><span class="var type1" id="S3T5U55">x</span>-<span class="var type1" id="S4T4U56">m</span></span>)'</span></span>,2)</span></span>;   <span class="comment">% Chris Bregler's trick</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,10" id="srcline10">10</a></span><span class="line"><span class="comment">%     if any(mahal&lt;0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,11" id="srcline11">11</a></span><span class="line"><span class="comment">%         %warning('mahal &lt; 0 =&gt; C is not psd')   % revised Jul. 25, 2015</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,12" id="srcline12">12</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,13" id="srcline13">13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T2:U36"><span class="var type1" id="S2T2U60">p</span> = <span class="mxinfo " id="T2:U38"><span class="mxinfo " id="T2:U39"><span class="mxinfo " id="T4:U40">-0.5</span>*<span class="var type1" id="S13T2U65">mahal</span></span> - <span class="mxinfo " id="T4:U42">log(<span class="var type1" id="S8T4U68">denom</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,16" id="srcline16">16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,17" id="srcline17">17</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
